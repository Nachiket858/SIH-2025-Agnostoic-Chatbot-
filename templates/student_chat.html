<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>College Query Assistant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .custom-scrollbar::-webkit-scrollbar { width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #c5c5c5; border-radius: 10px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .message-animation { animation: fadeIn 0.3s ease-out; }
    .message-user { border-radius: 18px 18px 4px 18px; }
    .message-assistant { border-radius: 18px 18px 18px 4px; }
  </style>
</head>
<body class="bg-gray-50">
  <div class="flex flex-col h-screen">
    <header class="bg-indigo-600 text-white shadow-lg">
      <div class="container mx-auto px-4 py-3 flex justify-between items-center">
        <div class="flex items-center space-x-2">
          <i class="fas fa-graduation-cap text-2xl"></i>
          <h1 class="text-xl font-bold">College Query Assistant</h1>
        </div>
        <div class="flex space-x-2">
          <a href="/reset_chat" class="bg-indigo-700 px-4 py-2 rounded">New Chat</a>
          <a href="/" class="bg-gray-700 px-4 py-2 rounded">Home</a>
        </div>
      </div>
    </header>

    <div class="flex flex-1 overflow-hidden container mx-auto px-4 py-5">
    
      <div class="w-1/4 pr-4 hidden md:block">
        <div class="bg-white rounded-xl shadow-sm p-4 h-full">
          <h2 class="font-semibold text-gray-700 mb-4 flex items-center">
            <i class="fas fa-comments mr-2 text-indigo-500"></i> Chat Threads
          </h2>
          <div class="space-y-2 custom-scrollbar overflow-y-auto" style="max-height: calc(100vh - 180px);">
            {% for th in threads %}
              <a href="/switch_thread/{{ th }}" class="block">
                <div class="{% if th==current_thread %}bg-indigo-50 border-indigo-100 text-indigo-700{% else %}border-gray-200 text-gray-700 hover:bg-gray-50{% endif %} border rounded-lg p-3 cursor-pointer">
                  <h3 class="font-medium">Thread {{ loop.index }}</h3>
                  <p class="text-sm {% if th==current_thread %}text-indigo-500{% else %}text-gray-500{% endif %} truncate mt-1">
                    {% if th==current_thread %}Active conversation{% else %}Click to view{% endif %}
                  </p>
                </div>
              </a>
            {% endfor %}
          </div>
        </div>
      </div>

     
      <div class="flex-1 flex flex-col bg-white rounded-xl shadow-sm overflow-hidden">
      
        <div class="border-b border-gray-200 px-6 py-4">
          <h2 class="font-semibold text-gray-800">Thread {{ current_thread }}</h2>
          <p class="text-sm text-gray-500">Ask about notices, fees, structure, or other college-related queries</p>
        </div>

        
        <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-gray-50" id="chat-box">
          <div class="space-y-4">
            {% for msg in messages %}
              {% if msg.role=="user" %}
                <div class="message-animation flex justify-end">
                  <div class="message-user bg-indigo-500 text-white max-w-[80%] p-4 shadow-sm">
                    <p>{{ msg.content }}</p>
                  </div>
                </div>
              {% else %}
                <div class="message-animation flex justify-start">
                  <div class="message-assistant bg-white border border-gray-200 max-w-[80%] p-4 shadow-sm">
                    <div class="flex items-center mb-1">
                      <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center mr-2">
                        <i class="fas fa-robot text-indigo-500"></i>
                      </div>
                      <span class="font-medium text-gray-700">College Assistant</span>
                    </div>
                    <p class="text-gray-700">{{ msg.content }}</p>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>

   
        <div class="border-t border-gray-200 p-4 bg-white">
          <form method="POST" class="flex space-x-2">
            <input type="text" name="user_input" placeholder="Type your question about college..." required
                   class="flex-1 border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <button type="submit" class="bg-indigo-600 text-white rounded-lg px-5 py-3 hover:bg-indigo-700 flex items-center">
              <i class="fas fa-paper-plane mr-2"></i> Send
            </button>
          </form>

          <div class="mt-3 flex flex-wrap gap-2">
            <span class="text-xs text-gray-500">Quick queries:</span>
            <button class="quick-query text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full">Exam schedule</button>
            <button class="quick-query text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full">Fee structure</button>
            <button class="quick-query text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full">Academic calendar</button>
            <button class="quick-query text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full">Library hours</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Auto-scroll
    function scrollToBottom() {
      const chatBox = document.getElementById('chat-box');
      chatBox.scrollTop = chatBox.scrollHeight;
    }
    window.addEventListener('load', scrollToBottom);

    // quick queries
    document.querySelectorAll('.quick-query').forEach(button => {
      button.addEventListener('click', () => {
        const q = button.textContent;
        document.querySelector('input[name="user_input"]').value = q;
      });
    });
  </script>
</body>
</html>
